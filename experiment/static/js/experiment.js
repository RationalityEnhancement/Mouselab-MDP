// Generated by CoffeeScript 1.12.3

/*
experiment.coffee
Fred Callaway

Demonstrates the mouselab-mdp jspsych plugin
 */
var createStartButton, initializeExperiment, loadJson;

loadJson = function(file) {
  var result;
  result = $.ajax({
    dataType: 'json',
    url: file,
    async: false
  });
  return result.responseJSON;
};

$(window).on('load', function() {
  var expData;
  expData = loadJson("/static/json/condition_0_0.json");
  console.log('expData', expData);
  return initializeExperiment(expData.blocks);
});

createStartButton = function() {
  document.getElementById("loader").style.display = "none";
  document.getElementById("successLoad").style.display = "block";
  document.getElementById("failLoad").style.display = "none";
  return $('#load-btn').click(initializeExperiment);
};

initializeExperiment = function(blocks) {
  var experiment_timeline, main, welcome;
  console.log('INITIALIZE EXPERIMENT');
  welcome = {
    type: 'text',
    text: "<h1>Graph-MDP Demo</h1>\n\nThis is a demonstration of the Graph-MDP plugin.\n<p>\nPress <b>space</b> to continue.\n"
  };
  main = {
    type: 'graph',
    centerMessage: 'A simple cross',
    timeline: blocks.grid
  };
  experiment_timeline = [welcome, main];
  return jsPsych.init({
    display_element: $('#jspsych-target'),
    timeline: experiment_timeline,
    on_finish: function() {
      return jsPsych.data.displayData();
    },
    on_data_update: function(data) {
      return console.log('data', data);
    }
  });
};
